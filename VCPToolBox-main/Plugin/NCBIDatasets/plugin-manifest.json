{
  "manifestVersion": "1.0.0",
  "name": "NCBIDatasets",
  "version": "0.2.0",
  "displayName": "NCBI Datasets 查询插件",
  "description": "提供对 NCBI Datasets v2 API 的封装能力，用于检索基因组、基因与物种信息等。",
  "author": "B3000Kcn & DBL1F7E5",
  "pluginType": "synchronous",
  "entryPoint": {
    "type": "nodejs",
    "command": "node NCBIDatasets.mjs"
  },
  "communication": {
    "protocol": "stdio",
    "timeout": 30000
  },
  "configSchema": {
    "NCBI_BASE_URL": {
      "type": "string",
      "description": "NCBI Datasets API 基础地址，留空时使用官方默认 https://api.ncbi.nlm.nih.gov/datasets/v2",
      "default": "https://api.ncbi.nlm.nih.gov/datasets/v2"
    },
    "NCBI_API_KEY": {
      "type": "string",
      "description": "可选的 NCBI API Key，用于提高速率限制。没有可以留空。"
    },
    "NCBI_TIMEOUT": {
      "type": "number",
      "description": "HTTP 请求超时时间（毫秒）。",
      "default": 30000
    }
  },
  "capabilities": {
    "invocationCommands": [
      {
        "commandIdentifier": "search_genomes",
        "description": "按物种 tax_id 检索基因组装 (Genome Assemblies)，基于 NCBI Datasets v2 的 /genome/taxon/{tax_id}/dataset_report 接口。\n\n适用场景：\n- 想要列出某个物种（例如大肠杆菌、金黄色葡萄球菌等）在 NCBI 上收录的代表性/全部基因组装信息。\n- 需要为后续的基因组下载、比对或注释挑选合适的参考组装。\n\n参数说明（均在 TOOL_REQUEST 的 JSON 中作为字段传入）：\n- tax_id (number, 必需): NCBI taxonomy ID，例如大肠杆菌 K-12 的 tax_id 为 511145。插件内部会调用 /genome/taxon/{tax_id}/dataset_report。\n- max_results (number, 可选): 返回的最大记录数，1–1000，默认 50。\n- assembly_level (string, 可选): 组装层级过滤，可选值：\"complete\", \"chromosome\", \"scaffold\", \"contig\"。\n- assembly_source (string, 可选): 数据来源，可选值：\"refseq\", \"genbank\", \"all\"，默认 \"all\"。\n- page_token (string, 可选): 翻页用 token，当上一次调用返回了 next_page_token 时，可以带上它获取下一页。\n\n返回结果：\n- status: \"success\" 或 \"error\"。\n- result.content: 数组，包含一个 type=\"text\" 的元素，其 text 字段为 JSON 字符串，结构大致为：\n  {\n    \"search_parameters\": {…原始参数…},\n    \"total_count\": <NCBI 报告的总数>,\n    \"returned_count\": <本次返回的记录数>,\n    \"page_token\": <下一页 token，如有>,\n    \"genomes\": <NCBI Datasets 原始 reports 数组>\n  }\n\n调用格式示例（给 AI 看的模板）：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的署名「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」search_genomes「末」,\ntax_id:「始」511145「末」,\nmax_results:「始」20「末」,\nassembly_level:「始」chromosome「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」search_genomes「末」,\ntax_id:「始」511145「末」,\nmax_results:「始」10「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_gene_info",
        "description": "获取单个基因的详细信息，基于 NCBI Datasets v2 的 /gene/id/{gene_id}/dataset_report 和 /gene/symbol/... 接口。\n\n适用场景：\n- 已知 NCBI Gene ID，想要查看该基因的功能注释、基因组定位等详细信息。\n- 只有基因符号（symbol）+ 物种名，希望先搜索再获取该基因的完整信息。\n\n参数说明：\n（以下字段都直接放在 TOOL_REQUEST JSON 中，插件内部会自动路由到 get_gene_info）\n- gene_id (number, 可选): NCBI Gene ID。如果提供 gene_id，将优先使用 /gene/id/{gene_id}/dataset_report 直接获取。\n- gene_symbol (string, 可选): 基因符号，例如 \"tetX\"、\"gyrA\"。当未提供 gene_id 时，必须与 organism 搭配使用。\n- organism (string, 可选): 物种名称，例如 \"Escherichia coli\"。当使用 gene_symbol 搜索时必需。\n\n使用建议：\n- 如果用户给出了明确的基因 ID（例如 \"Gene ID: 7157\"），优先走 gene_id。\n- 如果用户只说“人类 TP53 基因”，则应设置 gene_symbol=\"TP53\" 且 organism=\"Homo sapiens\"。\n\n返回结果：\n- status: \"success\" 或 \"error\"。\n- result.content[0].text: JSON 字符串，直接为 NCBI Datasets 对应 gene id/report 的原始结构，便于后续由 AI 做二次解析/总结。\n\n调用格式示例：\n1）通过 Gene ID 查询：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_gene_info「末」,\ngene_id:「始」7157「末」\n<<<[END_TOOL_REQUEST]>>>\n\n2）通过基因符号 + 物种名查询：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_gene_info「末」,\ngene_symbol:「始」tetX「末」,\norganism:「始」Escherichia coli「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_gene_info「末」,\ngene_id:「始」7157「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_genome_info",
        "description": "获取单个基因组组装 (Genome Assembly) 的详细信息，包括元数据、注释和统计数据。\n\n参数:\n- accession (string, 必需): 基因组组装的 Accession 号，例如 'GCF_000001405.40'。\n- include_annotation (boolean, 可选): 是否包含注释信息 (默认为 true)。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_genome_info「末」,\naccession:「始」GCF_000001405.40「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_organism_info",
        "description": "获取某个物种的综合信息，包括 taxonomy 信息与可用的代表性基因组列表。内部会直接调用 /taxonomy/taxon/{name} 获取物种信息，并调用 /genome/taxon/{tax_id}/dataset_report 获取基因组列表。\n\n适用场景：\n- 用户只给出物种名（如 \"Klebsiella pneumoniae\"），希望快速获得：\n  - 该物种的 tax_id、分类地位、系统发育信息；\n  - NCBI 中可用的部分代表性基因组列表及数量。\n\n参数说明：\n- organism (string, 可选): 物种名称，如 \"Klebsiella pneumoniae\"。如果未提供 tax_id，则会直接使用该名称查询。\n- tax_id (number, 可选): 已知的 NCBI taxonomy ID。提供该值可以直接按 ID 查询。\n\n使用建议：\n- 当用户说“帮我看看某个菌种在 NCBI 上有哪些基因组”，优先调用本命令。\n- 若用户已给出 tax_id，则可以直接传 tax_id。\n\n返回结果结构：\n- status: \"success\" 或 \"error\"。\n- result.content[0].text: JSON 字符串，结构类似：\n  {\n    \"organism_info\": <taxonomy/taxon/{tax_id} 的返回>,\n    \"available_genomes\": </genome/taxon/.../dataset_report 返回的 reports 数组（前 10 条）>,\n    \"genome_count\": <dataset_report 报告的 total_count>\n  }\n\n调用格式示例：\n1）通过物种名：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_organism_info「末」,\norganism:「始」Klebsiella pneumoniae「末」\n<<<[END_TOOL_REQUEST]>>>\n\n2）通过 tax_id：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_organism_info「末」,\ntax_id:「始」573「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_organism_info「末」,\norganism:「始」Escherichia coli「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_assembly_info",
        "description": "获取单个基因组组装 (Assembly) 的详细元数据和统计信息。\n\n参数:\n- assembly_accession (string, 必需): 组装的 Accession 号，例如 'GCF_000001405.40'。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_assembly_info「末」,\nassembly_accession:「始」GCF_000001405.40「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_assembly_reports",
        "description": "获取组装的通用数据集报告 (Dataset Report)。在 v2 API 中，这是一个综合性报告，包含了元数据、统计信息等。\n\n参数:\n- assembly_accession (string, 必需): 组装的 Accession 号。\n- report_type (string, 可选): 用于在返回结果中标记报告类型的标签，虽然 v2 API 端点已统一，但此参数可用于区分调用意图。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_assembly_reports「末」,\nassembly_accession:「始」GCF_000001405.40「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_database_stats",
        "description": "获取 NCBI Datasets 数据库内容的统计信息 (v2 API 中此功能已移除，会返回提示信息)。\n\n参数:\n- data_type (string, 可选): 'genomes', 'genes', 'proteins', 'assemblies', 'all'。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_database_stats「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "search_by_bioproject",
        "description": "通过 BioProject Accession 搜索关联的数据集。\n\n参数:\n- bioproject_accession (string, 必需): BioProject 的 Accession 号，例如 'PRJNA224116'。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」search_by_bioproject「末」,\nbioproject_accession:「始」PRJNA224116「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "search_by_biosample",
        "description": "通过 BioSample Accession 搜索关联的数据集。\n\n参数:\n- biosample_accession (string, 必需): BioSample 的 Accession 号，例如 'SAMN02422669'。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」search_by_biosample「末」,\nbiosample_accession:「始」SAMN02422669「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "search_assemblies",
        "description": "使用详细的过滤选项搜索基因组组装。注意：此功能的核心是按 tax_id 搜索。\n\n参数:\n- tax_id (number, 必需): NCBI Taxonomy ID。\n- query (string, 可选): 当 tax_id 未知时，可提供物种名作为 query，插件会尝试将其解析为 tax_id。不建议使用组装名等其他关键词。\n- assembly_level (string, 可选): 'complete', 'chromosome', 'scaffold', 'contig'。\n- max_results (number, 可选): 最大结果数。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」search_assemblies「末」,\nquery:「始」Escherichia coli「末」,\nassembly_level:「始」chromosome「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "search_genes",
        "description": "按基因符号、物种或 Gene ID 搜索基因。\n\n参数:\n- gene_id (number, 可选): NCBI Gene ID，最高效的查询方式。\n- gene_symbol (string, 可选): 基因符号 (例如 'BRCA1')。\n- organism (string, 可选): 物种名 (与 gene_symbol 联用)。\n- tax_id (number, 可选): NCBI Taxonomy ID (可与 gene_symbol 联用)。\n- max_results (number, 可选): 最大结果数。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」search_genes「末」,\ngene_symbol:「始」rpoB「末」,\norganism:「始」Escherichia coli「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "search_taxonomy",
        "description": "按物种名或关键词搜索分类学信息。\n\n参数:\n- query (string, 必需): 搜索查询 (物종名或分类学关键词)。\n- rank (string, 可选): 对返回结果按分类学等级进行过滤，例如 'species', 'genus'。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」search_taxonomy「末」,\nquery:「始」Klebsiella「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_taxonomic_lineage",
        "description": "获取一个物种的完整分类学谱系。\n\n参数:\n- tax_id (number, 必需): NCBI Taxonomy ID。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_taxonomic_lineage「末」,\ntax_id:「始」573「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_genome_summary",
        "description": "获取单个基因组组装的摘要统计信息。\n\n参数:\n- accession (string, 必需): 基因组组装的 Accession 号，例如 'GCF_000001405.40'。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_genome_summary「末」,\naccession:「始」GCF_000001405.40「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_taxonomy_info",
        "description": "获取单个分类单元 (taxon) 的详细分类学信息。\n\n参数:\n- tax_id (number, 必需): NCBI Taxonomy ID。\n- include_lineage (boolean, 可选): 是否包含完整的分类学谱系 (默认为 true)。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_taxonomy_info「末」,\ntax_id:「始」9606「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "search_virus_genomes",
        "description": "按病毒名称或分类单元搜索病毒基因组。\n\n参数:\n- virus_name (string, 可选): 病毒名称或物种名 (例如 'SARS-CoV-2')。\n- tax_id (number, 可选): NCBI Taxonomy ID。\n- max_results (number, 可选): 最大结果数。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」search_virus_genomes「末」,\nvirus_name:「始」SARS-CoV-2「末」,\nmax_results:「始」5「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_virus_info",
        "description": "获取单个病毒基因组的详细信息。\n\n参数:\n- accession (string, 必需): 病毒基因组的 Accession 号。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_virus_info「末」,\naccession:「始」NC_045512.2「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "search_proteins",
        "description": "[功能已弃用] 搜索蛋白质序列。在 v2 API 中，独立的蛋白质搜索功能已被移除，此命令会返回一条提示信息。\n\n参数:\n- protein_name (string, 可选): 蛋白质名称。\n- organism (string, 可选): 来源物种。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」search_proteins「末」,\nprotein_name:「始」hemoglobin「末」,\norganism:「始」Homo sapiens「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_protein_info",
        "description": "[功能已弃用] 获取单个蛋白质的详细信息。在 v2 API 中，独立的蛋白质信息获取功能已被移除，此命令会返回一条提示信息。\n\n参数:\n- protein_accession (string, 可选): 蛋白质的 Accession 号 (此参数在当前版本中将被忽略)。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_protein_info「末」,\nprotein_accession:「始」NP_000509.1「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_genome_annotation",
        "description": "获取一个基因组组装的注释报告 (Annotation Report)。\n\n参数:\n- accession (string, 必需): 基因组组装的 Accession 号。\n- annotation_type (string, 可选): 注释类型，可选 'genes', 'features'。\n- feature_type (string, 可选): 特征类型过滤，例如 'CDS', 'gene'。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_genome_annotation「末」,\naccession:「始」GCF_000001405.40「末」,\nannotation_type:「始」genes「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "search_genome_features",
        "description": "[功能已弃用] 搜索基因组特征。在 v2 API 中，全局的特征搜索已被移除。请使用 'get_genome_annotation' 在特定组装内进行搜索。此命令会返回一条提示信息。\n\n参数:\n- feature_name (string, 可选): 特征名称或基因符号。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」search_genome_features「末」,\nfeature_name:「始」TP53「末」,\norganism:「始」Homo sapiens「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_assembly_quality",
        "description": "获取基因组组装的质量评估报告。在 v2 API 中，质量信息已整合到主数据集中，此命令会返回完整的报告供解析。\n\n参数:\n- accession (string, 必需): 基因组组装的 Accession 号。",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」NCBIDatasets「末」,\ncommand:「始」get_assembly_quality「末」,\naccession:「始」GCF_000001405.40「末」\n<<<[END_TOOL_REQUEST]>>>"
      }
    ]
  }
}