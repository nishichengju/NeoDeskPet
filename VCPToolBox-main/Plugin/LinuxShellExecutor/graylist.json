{"_comment": "灰名单 - 需要管理员验证的运维命令（介于白名单和黑名单之间）",
    "_version": "0.3.1",
    "_description": "这些命令功能强大，可能影响系统状态，因此需要管理员验证码才能执行",
    "commands": {
        "systemctl": {
            "description": "服务管理（完整控制）",
            "allowedArgs": [
                "status", "is-active", "is-enabled", "list-units", "list-unit-files",
                "start", "stop", "restart", "reload", "enable", "disable",
                "--type=service", "--state=running", "--state=failed", "--no-pager", "-l"
            ],
            "noPathRequired": true,
            "riskLevel": "high",
            "note": "允许服务控制操作，需要验证"
        },
        "service": {
            "description": "服务管理（传统命令）",
            "allowedArgs": ["status", "start", "stop", "restart", "reload"],
            "noPathRequired": true,
            "riskLevel": "high"
        },
        "kill": {
            "description": "终止进程",
            "allowedArgs": ["-9", "-15", "-TERM", "-KILL", "-HUP", "-INT", "-s"],
            "noPathRequired": true,
            "riskLevel": "high",
            "note": "允许终止进程，需要验证"
        },
        "killall": {
            "description": "按名称终止进程",
            "allowedArgs": ["-9", "-15", "-TERM", "-KILL", "-s", "-u", "-w"],
            "noPathRequired": true,
            "riskLevel": "high"
        },
        "pkill": {
            "description": "按模式终止进程",
            "allowedArgs": ["-9", "-15", "-TERM", "-KILL", "-f", "-u", "-x"],
            "noPathRequired": true,
            "riskLevel": "high"
        },
        "htop": {
            "description": "交互式进程监控",
            "allowedArgs": ["-d", "-u", "-p", "-s"],
            "noPathRequired": true,
            "riskLevel": "medium",
            "note": "交互式工具，可能需要特殊终端支持"
        },
        "docker": {
            "description": "Docker 完整管理",
            "allowedArgs": [
                "ps", "logs", "inspect", "stats", "images", "info", "version",
                "exec", "start", "stop", "restart", "pause", "unpause",
                "top", "port", "diff", "events", "history",
                "-a", "--no-trunc", "-n", "--tail", "-f", "-i", "-t", "--rm",
                "--format", "-q", "--filter"
            ],
            "noPathRequired": true,
            "riskLevel": "high",
            "note": "允许容器控制操作（exec/start/stop/restart），禁止 run/rm/rmi/build/push/pull"
        },
        "docker-compose": {
            "description": "Docker Compose 管理",
            "allowedArgs": [
                "ps", "logs", "config", "images", "top", "events",
                "up", "down", "start", "stop", "restart", "pause", "unpause",
                "-d", "-f", "--tail", "--follow", "--no-deps", "--build"
            ],
            "noPathRequired": true,
            "riskLevel": "high",
            "note": "允许编排服务控制"
        },
        "journalctl": {
            "description": "系统日志查询（扩展）",
            "allowedArgs": [
                "-u", "-n", "-f", "--since", "--until", "-p", "-b", 
                "--no-pager", "-e", "-x", "-r", "-o", "--vacuum-size", 
                "--vacuum-time", "--disk-usage", "-k", "--list-boots"
            ],
            "noPathRequired": true,
            "riskLevel": "medium",
            "maxLines": 1000
        },
        "tail": {
            "description": "实时日志追踪（-f 模式）",
            "allowedArgs": ["-n", "-f", "-F", "-c", "--follow", "--retry"],
            "pathRestrictions": {
                "allowed": ["/var/log", "/home", "/tmp", "/opt"],
                "denied": ["/etc/shadow", "/etc/passwd", "/root", "/proc", "/sys"]
            },
            "riskLevel": "medium",
            "note": "-f 模式可能长时间运行"
        },
        "ping": {
            "description": "网络连通性测试（扩展）",
            "allowedArgs": ["-c", "-W", "-i", "-s", "-t", "-q", "-v", "-4", "-6"],
            "noPathRequired": true,
            "riskLevel": "low",
            "maxCount": 100,
            "note": "允许更多 ping 次数"
        },
        "traceroute": {
            "description": "路由追踪",
            "allowedArgs": ["-n", "-m", "-w", "-q", "-I", "-T", "-U", "-4", "-6"],
            "noPathRequired": true,
            "riskLevel": "low",
            "maxHops": 64
        },
        "mtr": {
            "description": "网络诊断（ping + traceroute）",
            "allowedArgs": ["-n", "-r", "-c", "-w", "-b", "-o", "--report"],
            "noPathRequired": true,
            "riskLevel": "low"
        },
        "curl": {
            "description": "HTTP 请求（完整功能）",
            "allowedArgs": [
                "-I", "-s", "-S", "-o", "-w", "-m", "-H", "-L", "-k", "-v",
                "-X", "-d", "-F", "--data-raw", "--connect-timeout",
                "-u", "-A", "-e", "-b", "-c", "--compressed", "-O"
            ],
            "noPathRequired": true,
            "riskLevel": "medium",
            "note": "允许 POST/PUT 等方法，用于 API 调试"
        },
        "wget": {
            "description": "HTTP 下载",
            "allowedArgs": [
                "--spider", "-q", "-O", "--timeout", "-T", "-c", "-r", 
                "--no-check-certificate", "-P", "--limit-rate"
            ],
            "noPathRequired": true,
            "riskLevel": "medium",
            "note": "允许实际下载文件"
        },
        "nc": {
            "description": "网络调试工具",
            "allowedArgs": ["-v", "-z", "-w", "-l", "-p", "-u", "-n"],
            "noPathRequired": true,
            "riskLevel": "medium",
            "note": "网络连接测试，禁止 -e 执行命令"
        },
        "netcat": {
            "description": "网络调试工具（别名）",
            "allowedArgs": ["-v", "-z", "-w", "-l", "-p", "-u", "-n"],
            "noPathRequired": true,
            "riskLevel": "medium"
        },
        "tcpdump": {
            "description": "网络抓包",
            "allowedArgs": ["-i", "-n", "-c", "-w", "-r", "-s", "-A", "-X", "-v", "-vv"],
            "noPathRequired": true,
            "riskLevel": "high",
            "note": "网络流量分析，需要 root 权限"
        },
        "ip": {
            "description": "网络配置查看",
            "allowedArgs": ["a", "addr", "link", "route", "r", "neigh", "n", "-s", "-4", "-6", "show"],
            "noPathRequired": true,
            "riskLevel": "low",
            "note": "仅允许查看操作，禁止 add/del/set"
        },
        "ss": {
            "description": "Socket 统计（扩展）",
            "allowedArgs": ["-t", "-u", "-l", "-n", "-p", "-a", "-s", "-e", "-m", "-o", "-i"],
            "noPathRequired": true,
            "riskLevel": "low"
        },
        "lsof": {
            "description": "列出打开的文件/端口（扩展）",
            "allowedArgs": ["-i", "-p", "-n", "-P", "-u", "-c", "+D", "-t"],
            "noPathRequired": true,
            "riskLevel": "low"
        },
        "pgrep": {
            "description": "按名称查找进程",
            "allowedArgs": ["-f", "-l", "-a", "-u", "-x", "-n", "-o", "-c"],
            "noPathRequired": true,
            "riskLevel": "low"
        },
        "vmstat": {
            "description": "虚拟内存统计（扩展）",
            "allowedArgs": ["-s", "-d", "-w", "-a", "-m", "-n"],
            "noPathRequired": true,
            "riskLevel": "low",
            "maxIterations": 60,
            "note": "允许更长时间的监控"
        },
        "iostat": {
            "description": "IO 统计（扩展）",
            "allowedArgs": ["-x", "-d", "-c", "-h", "-k", "-m", "-p", "-t", "-y"],
            "noPathRequired": true,
            "riskLevel": "low",
            "maxIterations": 60
        },
        "sar": {
            "description": "系统活动报告（扩展）",
            "allowedArgs": ["-u", "-r", "-b", "-d", "-n", "-q", "-w", "-A", "-f"],
            "noPathRequired": true,
            "riskLevel": "low"
        },
        "top": {
            "description": "系统监控（扩展）",
            "allowedArgs": ["-b", "-n", "-d", "-p", "-u", "-H", "-c"],
            "noPathRequired": true,
            "riskLevel": "low",
            "maxIterations": 60,
            "note": "允许更多迭代次数"
        },
        "dmesg": {
            "description": "内核日志（扩展）",
            "allowedArgs": ["-T", "-H", "-w", "-W", "--level=err", "--level=warn", "-n", "-c", "-f"],
            "noPathRequired": true,
            "riskLevel": "medium",
            "note": "-c 会清除日志，需要验证"
        },
        "free": {
            "description": "内存使用情况（扩展）",
            "allowedArgs": ["-m", "-h", "-g", "-b", "-k", "-s", "-c", "-w", "-t"],
            "noPathRequired": true,
            "riskLevel": "low"
        },
        "uptime": {
            "description": "系统运行时间",
            "allowedArgs": ["-p", "-s"],
            "noPathRequired": true,
            "riskLevel": "low"
        },
        "mysql": {
            "description": "MySQL 管理（扩展）",
            "allowedArgs": ["-e", "-u", "-p", "-h", "-P", "--skip-column-names", "-N", "-B", "-t"],
            "noPathRequired": true,
            "riskLevel": "high",
            "note": "允许执行 SQL 查询，需要验证"
        },
        "mysqladmin": {
            "description": "MySQL 管理工具",
            "allowedArgs": ["status", "processlist", "ping", "version", "variables", "-u", "-p", "-h"],
            "noPathRequired": true,
            "riskLevel": "medium"
        },
        "redis-cli": {
            "description": "Redis 管理（扩展）",
            "allowedArgs": [
                "-h", "-p", "-a", "-n", "--scan", "--pattern",
                "INFO", "PING", "DBSIZE", "CLIENT", "CONFIG", "SLOWLOG",
                "KEYS", "GET", "SET", "DEL", "HGET", "HGETALL", "LRANGE"
            ],
            "noPathRequired": true,
            "riskLevel": "high",
            "note": "允许读写操作，需要验证"
        },
        "psql": {
            "description": "PostgreSQL 客户端",
            "allowedArgs": ["-c", "-d", "-h", "-p", "-U", "-l", "-t", "-A", "-F"],
            "noPathRequired": true,
            "riskLevel": "high"
        },
        "mongo": {
            "description": "MongoDB 客户端",
            "allowedArgs": ["--eval", "--host", "--port", "-u", "-p", "--authenticationDatabase"],
            "noPathRequired": true,
            "riskLevel": "high"
        },
        "nginx": {
            "description": "Nginx 管理",
            "allowedArgs": ["-t", "-T", "-v", "-V", "-s", "-c"],
            "noPathRequired": true,
            "riskLevel": "high",
            "note": "-s reload/stop/quit 需要验证"
        },
        "apachectl": {
            "description": "Apache 管理",
            "allowedArgs": ["status", "configtest", "graceful", "restart", "start", "stop", "-t", "-S"],
            "noPathRequired": true,
            "riskLevel": "high"
        },
        "crontab": {
            "description": "定时任务查看",
            "allowedArgs": ["-l", "-u"],
            "noPathRequired": true,
            "riskLevel": "medium",
            "note": "仅允许查看，禁止 -e/-r 编辑删除"
        },
        "at": {
            "description": "定时任务查看",
            "allowedArgs": ["-l", "-c"],
            "noPathRequired": true,
            "riskLevel": "medium"
        },
        "timedatectl": {
            "description": "时间日期管理",
            "allowedArgs": ["status", "show", "list-timezones", "set-timezone", "set-time"],
            "noPathRequired": true,
            "riskLevel": "medium"
        },
        "hostnamectl": {
            "description": "主机名管理",
            "allowedArgs": ["status", "set-hostname"],
            "noPathRequired": true,
            "riskLevel": "medium"
        },
        "reboot": {
            "description": "重启系统",
            "allowedArgs": ["--help"],
            "noPathRequired": true,
            "riskLevel": "critical",
            "note": "危险操作，需要验证"
        },
        "shutdown": {
            "description": "关机/重启",
            "allowedArgs": ["-r", "-h", "-c", "+1", "+5", "+10", "now"],
            "noPathRequired": true,
            "riskLevel": "critical",
            "note": "危险操作，需要验证"
        },
        "init": {
            "description": "系统运行级别",
            "allowedArgs": ["0", "1", "3", "5", "6"],
            "noPathRequired": true,
            "riskLevel": "critical"
        }
    },
    "globalRestrictions": {
        "maxCommandLength": 2000,
        "maxPipelineDepth": 5,
        "allowedPipeCommands": [
            "grep", "head", "tail", "wc", "sort", "uniq", "cut", "awk", "sed",
            "xargs", "tr", "tee", "column", "less", "more", "jq", "yq"
        ],
        "forbiddenCharacters": [";", "&&", "||", "`", "$(", "${", ">>", "<<", "&"],
        "forbiddenInPipe": ["rm", "mv", "cp", "chmod", "chown", "dd", "mkfs"],
        "note": "灰名单允许 > 重定向用于日志导出，但禁止 >> 追加"
    },
    
    "riskLevels": {
        "low": {
            "description": "低风险 - 只读查询操作",
            "requiresAuth": true,
            "timeout": 30000
        },
        "medium": {
            "description": "中风险 - 可能影响系统状态",
            "requiresAuth": true,
            "timeout": 60000
        },
        "high": {
            "description": "高风险 - 服务控制/数据操作",
            "requiresAuth": true,
            "timeout": 120000
        },
        "critical": {
            "description": "极高风险 - 系统级操作",
            "requiresAuth": true,
            "timeout": 300000,
            "doubleConfirm": true
        }
    }
}