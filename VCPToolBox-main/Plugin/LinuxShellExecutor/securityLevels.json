{"_comment": "LinuxShellExecutor v0.4.0 - 四级安全分级配置",
    "_version": "0.4.0",
    "_description": "将命令分为 read/safe/write/danger 四个安全级别，支持灵活的管道和重定向控制",
    
    "securityLevels": {
        "read": {
            "description": "只读命令，自动放行",
            "commands": [
                "cat", "tail", "head", "grep", "awk", "sed", "less", "more",
                "ls", "ll", "find", "locate", "which", "whereis", "file", "stat",
                "ps", "top", "htop", "free", "df", "du", "uptime", "w", "who",
                "netstat", "ss", "ip", "ifconfig", "ping", "traceroute", "dig", "nslookup",
                "journalctl", "dmesg", "last", "history", "id", "whoami", "hostname",
                "uname", "date", "env", "printenv", "lscpu", "lsmem", "lsblk", "lspci", "lsusb",
                "wc", "sort", "uniq", "cut", "tr", "column", "tee", "xargs",
                "vmstat", "iostat", "sar", "mpstat", "pidstat", "echo"
            ],
            "allowPipe": true,
            "allowRedirect": false,
            "requireConfirm": false,
            "timeout": 30000
        },
        "safe": {
            "description": "低风险命令，自动放行",
            "commands": [
                "systemctl status", "systemctl is-active", "systemctl is-enabled", "systemctl list-units", "systemctl list-unit-files",
                "docker ps", "docker logs", "docker inspect", "docker stats", "docker images", "docker info", "docker version",
                "kubectl get", "kubectl describe", "kubectl logs", "kubectl top",
                "nginx -t", "nginx -T", "apache2ctl -t", "apachectl configtest",
                "mysql -e 'SHOW", "mysql -e 'SELECT", "psql -c 'SELECT", "psql -l",
                "redis-cli INFO", "redis-cli PING", "redis-cli DBSIZE",
                "crontab -l", "at -l",
                "timedatectl status", "hostnamectl status",
                "pgrep", "lsof"
            ],
            "allowPipe": true,
            "allowRedirect": false,
            "requireConfirm": false,
            "timeout": 60000
        },
        "write": {
            "description": "写操作，需要确认",
            "commands": [
                "tee", "touch", "mkdir", "cp", "mv",
                "systemctl start", "systemctl stop", "systemctl restart", "systemctl reload",
                "systemctl enable", "systemctl disable",
                "docker start", "docker stop", "docker restart", "docker pause", "docker unpause",
                "docker exec", "docker-compose up", "docker-compose down",
                "kubectl apply", "kubectl delete", "kubectl scale", "kubectl rollout",
                "vim", "nano", "sed -i",
                "nginx -s reload", "nginx -s stop",
                "mysql -e 'INSERT", "mysql -e 'UPDATE", "mysql -e 'DELETE",
                "redis-cli SET", "redis-cli DEL", "redis-cli FLUSHDB",
                "curl -X POST", "curl -X PUT", "curl -d", "wget -O",
                "kill", "killall", "pkill",
                "timedatectl set-timezone", "hostnamectl set-hostname"
            ],
            "allowPipe": true,
            "allowRedirect": true,
            "requireConfirm": true,
            "confirmMessage": "此命令将执行写操作，可能修改系统状态。确认执行？",
            "timeout": 120000
        },
        "danger": {
            "description": "高危命令，二次确认",
            "commands": [
                "rm", "rmdir", "dd", "mkfs", "fdisk", "parted", "mount", "umount",
                "reboot", "shutdown", "init", "halt", "poweroff",
                "chmod 777", "chmod -R", "chown", "chown -R",
                "iptables", "firewall-cmd", "ufw",
                "kill -9", "kill -KILL", "killall -9",
                "docker rm", "docker rmi", "docker system prune",
                "kubectl delete --all", "kubectl delete namespace",
                "mysql -e 'DROP", "mysql -e 'TRUNCATE",
                "redis-cli FLUSHALL",
                "crontab -e", "crontab -r"
            ],
            "allowPipe": false,
            "allowRedirect": false,
            "requireConfirm": "double",
            "confirmMessage": "⚠️ 警告：此命令为高危操作，可能导致数据丢失或系统不可用！请输入确认码以继续。",
            "timeout": 300000
        }
    },
    "pipeRules": {
        "_comment": "管道链规则：定义哪些安全级别的命令可以通过管道连接",
        "allowedPipeChains": [
            "read -> read",
            "read -> safe",
            "safe -> read",
            "safe -> safe",
            "write -> read"
        ],
        "forbiddenPipeChains": [
            "* -> danger",
            "danger -> *",
            "* -> write"
        ],
        "maxPipelineDepth": 5,
        "allowedPipeCommands": [
            "grep", "head", "tail", "wc", "sort", "uniq", "cut", "awk", "sed",
            "xargs", "tr", "tee", "column", "less", "more", "jq", "yq"
        ],
        "forbiddenInPipe": [
            "rm", "mv", "cp", "chmod", "chown", "dd", "mkfs",
            "curl", "wget", "mysql", "redis-cli", "psql"
        ]
    },
    
    "redirectRules": {
        "_comment": "重定向规则",
        "allowedRedirectLevels": ["write"],
        "allowedRedirectTargets": [
            "/tmp/*",
            "/var/log/*",
            "/home/*",
            "~/.*"
        ],
        "forbiddenRedirectTargets": [
            "/etc/*",
            "/root/*",
            "/dev/*",
            "/proc/*",
            "/sys/*",
            "/boot/*"
        ],
        "allowAppend": false,
        "allowOverwrite": true
    },
    
    "specialOperators": {
        "_comment": "特殊操作符规则",
        "semicolon": {
            "allowed": false,
            "reason": "禁止命令分隔符，防止命令注入"
        },
        "andAnd": {
            "allowed": true,
            "allowedLevels": ["read", "safe"],
            "reason": "仅允许只读和安全命令使用 &&"
        },
        "orOr": {
            "allowed": true,
            "allowedLevels": ["read", "safe"],
            "reason": "仅允许只读和安全命令使用 ||"
        },
        "backgroundAmp": {
            "allowed": false,
            "reason": "禁止后台执行"
        },
        "subshell": {
            "allowed": false,
            "reason": "禁止子shell执行 $() 和 ``"
        }
    },
    
    "commandAliases": {
        "_comment": "命令别名映射",
        "ll": "ls -l",
        "la": "ls -la",
        "l": "ls -CF"
    },
    
    "globalSettings": {
        "defaultLevel": "read",
        "unknownCommandLevel": "danger",
        "maxCommandLength": 2000,
        "maxOutputLines": 100,
        "maxOutputSize": 1048576,
        "enableConfirmation": true,
        "confirmationTimeout": 30000
    }
}