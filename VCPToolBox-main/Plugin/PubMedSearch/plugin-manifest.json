{
  "manifestVersion": "1.0.0",
  "name": "PubMedSearch",
  "version": "1.0.0",
  "displayName": "PubMed 文献检索插件",
  "description": "提供基于 NCBI E-utilities 和 PMC 的 PubMed 文献检索、详情获取、引用/相似文献分析与标识符转换等能力。实现参考 PubMed-MCP-Server 原始实现，保持结果结构和语义尽量一致，便于从 MCP 平滑迁移。",
  "author": "B3000Kcn & DBL1F7E5",
  "pluginType": "synchronous",
  "entryPoint": {
    "type": "node",
    "command": "node PubMedSearch.mjs"
  },
  "communication": {
    "protocol": "stdio",
    "timeout": 60000
  },
  "configSchema": {
    "NCBI_API_KEY": {
      "type": "string",
      "description": "NCBI E-utilities API Key，用于提升 PubMed 请求速率（可选，但强烈建议配置）。"
    },
    "NCBI_EMAIL": {
      "type": "string",
      "description": "用于标识调用方的电子邮箱地址（可选，建议配置，例如 your.name@domain）。"
    }
  },
  "capabilities": {
    "invocationCommands": [
      {
        "commandIdentifier": "search_articles",
        "description": "在 PubMed 中按关键词、作者、期刊、日期范围等进行综合检索，返回 PMID 列表与部分摘要信息。\n\n核心能力：\n- 封装 NCBI E-utilities 的 esearch + esummary 调用逻辑\n- 支持常见排序方式（相关度、发布日期、作者、期刊）\n- 支持日期范围筛选（YYYY/MM/DD 格式）\n\n参数：\n- command (字符串, 必需): 固定为 \"search_articles\"。\n- query (字符串, 必需): 检索表达式，例如：\n  - \"cancer treatment\"\n  - \"Smith J[Author]\"\n  - \"Nature[Journal]\"\n- max_results (数字, 可选): 返回的最大结果数，1–1000，默认 20。\n- start (数字, 可选): 分页起始位置，默认 0。\n- sort (字符串, 可选): 排序方式，可选值：\n  - \"relevance\"  按相关度\n  - \"pub_date\"   按发表日期\n  - \"author\"     按作者\n  - \"journal\"    按期刊\n- date_from (字符串, 可选): 起始日期，格式 YYYY/MM/DD。\n- date_to (字符串, 可选): 截止日期，格式 YYYY/MM/DD。\n\n返回：\n- result.content[0].text 为 JSON 字符串，字段与 MCP 保持一致，形如：\n  {\n    \"totalResults\": number,\n    \"returnedResults\": number,\n    \"start\": number,\n    \"pmids\": string[],\n    \"articles\": Array<{\n      pmid, title, authors, journal, publicationDate, doi\n    }>,\n    \"queryTranslation\": string\n  }\n\n调用格式示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」search_articles「末」,\nquery:「始」cancer immunotherapy「末」,\nmax_results:「始」20「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」search_articles「末」,\nquery:「始」CRISPR gene editing[Title/Abstract]「末」,\nmax_results:「始」30「末」,\nsort:「始」pub_date「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "advanced_search",
        "description": "执行字段级高级检索，将标题、摘要、作者、期刊、MeSH 术语、文献类型等组合成复杂布尔查询，并返回匹配 PMID 列表。\n\n核心能力：\n- 复用 MCP 中 buildFieldQuery / combineSearchTerms 逻辑\n- title/abstract/author/journal + MeSH + publication_types 多字段组合\n\n参数：\n- command (字符串, 必需): 固定为 \"advanced_search\"。\n- title (字符串, 可选): 仅在标题中检索的关键词。\n- abstract (字符串, 可选): 仅在摘要中检索的关键词。\n- author (字符串, 可选): 作者名称。\n- journal (字符串, 可选): 期刊名。\n- mesh_terms (字符串数组, 可选): MeSH 术语列表。\n- publication_types (字符串数组, 可选): 文献类型列表（如 \"Clinical Trial\", \"Review\"）。\n- boolean_operator (字符串, 可选): 各字段间布尔关系，\"AND\" 或 \"OR\"，默认 AND。\n- max_results (数字, 可选): 最大返回数，默认 20，上限 1000。\n\n返回：\n- JSON 字段：\n  {\n    \"query\": string,          // 实际提交给 PubMed 的检索式\n    \"totalResults\": number,\n    \"pmids\": string[]\n  }\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」advanced_search「末」,\ntitle:「始」single-cell RNA-seq「末」,\nabstract:「始」tumor microenvironment「末」,\nmesh_terms:「始」[\"Neoplasms\", \"Single-Cell Analysis\"]「末」,\nboolean_operator:「始」AND「末」,\nmax_results:「始」100「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」advanced_search「末」,\nauthor:「始」Smith J「末」,\nmesh_terms:「始」[\"Metagenomics\"]「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "search_by_author",
        "description": "按作者及其单位进行检索，返回该作者相关文献的 PMID 列表。\n\n参数：\n- command (字符串, 必需): 固定为 \"search_by_author\"。\n- author_name (字符串, 必需): 作者姓名，例如 \"Smith J\" 或 \"John Smith\"。\n- affiliation (字符串, 可选): 作者所在机构/单位信息，用于进一步过滤。\n- max_results (数字, 可选): 最大结果数，默认 50，上限 1000。\n\n返回：\n- JSON 字段：\n  {\n    \"author\": string,\n    \"affiliation\": string | null,\n    \"totalResults\": number,\n    \"pmids\": string[]\n  }\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」search_by_author「末」,\nauthor_name:「始」Ni YH「末」,\naffiliation:「始」Fudan University「末」,\nmax_results:「始」100「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」search_by_author「末」,\nauthor_name:「始」John Smith「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "search_by_journal",
        "description": "在指定期刊内按关键字和时间范围检索文章。\n\n参数：\n- command (字符串, 必需): 固定为 \"search_by_journal\"。\n- journal_name (字符串, 必需): 期刊名称或缩写。\n- keywords (字符串, 可选): 期刊内进一步筛选的关键字表达式。\n- date_from (字符串, 可选): 起始日期 YYYY/MM/DD。\n- date_to (字符串, 可选): 截止日期 YYYY/MM/DD。\n- max_results (数字, 可选): 最大结果数，默认 50，上限 1000。\n\n返回：\n- JSON 字段：\n  {\n    \"journal\": string,\n    \"keywords\": string,\n    \"dateRange\": { from, to },\n    \"totalResults\": number,\n    \"pmids\": string[]\n  }\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」search_by_journal「末」,\njournal_name:「始」Nature Microbiology「末」,\nkeywords:「始」antibiotic resistance「末」,\nmax_results:「始」100「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」search_by_journal「末」,\njournal_name:「始」Cell Reports「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "search_by_mesh_terms",
        "description": "基于 MeSH (Medical Subject Headings) 术语进行检索，可选择仅限于“主要主题”。\n\n参数：\n- command (字符串, 必需): 固定为 \"search_by_mesh_terms\"。\n- mesh_terms (字符串数组, 必需): MeSH 术语列表。\n- major_topic_only (布尔, 可选): 是否仅返回将该术语标记为 Major Topic 的文章，默认 false。\n- max_results (数字, 可选): 最大结果数，默认 50，上限 1000。\n\n返回：\n- JSON 字段：\n  {\n    \"meshTerms\": string[],\n    \"majorTopicOnly\": boolean,\n    \"totalResults\": number,\n    \"pmids\": string[]\n  }\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」search_by_mesh_terms「末」,\nmesh_terms:「始」[\"Drug Resistance, Microbial\", \"Biofilms\"]「末」,\nmajor_topic_only:「始」true「末」,\nmax_results:「始」200「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」search_by_mesh_terms「末」,\nmesh_terms:「始」[\"CRISPR-Cas Systems\"]「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_trending_articles",
        "description": "在给定研究领域/主题下，获取最近一段时间内（如最近 30 天）的新发表或“趋势”文献列表。\n\n参数：\n- command (字符串, 必需): 固定为 \"get_trending_articles\"。\n- field (字符串, 必需): 研究领域或主题关键字，如 \"metagenomics\"、\"single-cell\"。\n- days (数字, 可选): 回溯的天数区间，默认 30，范围 1–365。\n- max_results (数字, 可选): 最大结果数，默认 20，上限 100。\n\n返回：\n- JSON 字段：\n  {\n    \"field\": string,\n    \"days\": number,\n    \"dateRange\": { from, to },\n    \"totalResults\": number,\n    \"pmids\": string[]\n  }\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」get_trending_articles「末」,\nfield:「始」large language model「末」,\ndays:「始」7「末」,\nmax_results:「始」50「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」get_trending_articles「末」,\nfield:「始」antimicrobial resistance「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_article_details",
        "description": "根据 PMID 获取完整的文章元数据（标题、作者、摘要、期刊、DOI、MeSH、关键字、资助信息等）。\n\n参数：\n- command (字符串, 必需): 固定为 \"get_article_details\"。\n- pmid (字符串, 必需): PubMed ID，仅允许数字格式。\n\n返回：\n- 结构与 MCP 中 PubMedArticle 类型一致的 JSON（以字符串形式放在 result.content[0].text）。\n- 无需 AI 再做字段解析时，可直接将该 JSON 传给后续工具或保存为文件。\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」get_article_details「末」,\npmid:「始」12345678「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」get_article_details「末」,\npmid:「始」37912345「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_abstract",
        "description": "根据 PMID 获取文章的精简摘要信息（PMID、标题、摘要文本、作者、期刊、发表日期），便于快速概览。\n\n参数：\n- command (字符串, 必需): 固定为 \"get_abstract\"。\n- pmid (字符串, 必需): PubMed ID。\n\n返回：\n- JSON 字段：\n  {\n    \"pmid\": string,\n    \"title\": string,\n    \"abstract\": string,\n    \"authors\": Author[],\n    \"journal\": string,\n    \"publicationDate\": string\n  }\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」get_abstract「末」,\npmid:「始」37912345「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」get_abstract「末」,\npmid:「始」12345678「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_full_text",
        "description": "通过 PMC ID 从 PubMed Central 获取开放获取全文，包括结构化的章节、图表、参考文献等。该能力仅在文章已在 PMC 收录时可用。\n\n参数：\n- command (字符串, 必需): 固定为 \"get_full_text\"。\n- pmcid (字符串, 必需): PMC ID，可以是 \"PMC1234567\" 或纯数字 \"1234567\"，内部会自动标准化为 PMC 前缀。\n\n返回：\n- JSON 字段与 MCP 中 FullTextArticle 一致，例如：\n  {\n    \"pmcid\": string,\n    \"pmid\": string,\n    \"title\": string,\n    \"abstract\": string,\n    \"body\": string,\n    \"authors\": [...],\n    \"journal\": string,\n    \"publicationDate\": string,\n    \"doi\": string,\n    \"sections\": [...],\n    \"figures\": [...],\n    \"tables\": [...],\n    \"references\": [...]\n  }\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」get_full_text「末」,\npmcid:「始」PMC1234567「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」get_full_text「末」,\npmcid:「始」9876543「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "batch_article_lookup",
        "description": "批量按 PMID 列表获取文章详细信息（单次最多 200 条），内部自动做分块请求与合并。\n\n参数：\n- command (字符串, 必需): 固定为 \"batch_article_lookup\"。\n- pmids (字符串数组, 必需): PMID 列表，非空，长度 1–200。\n\n返回：\n- JSON 字段：\n  {\n    \"totalRequested\": number,\n    \"totalRetrieved\": number,\n    \"articles\": PubMedArticle[]\n  }\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」batch_article_lookup「末」,\npmids:「始」[\"12345678\", \"23456789\", \"34567890\"]「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」batch_article_lookup「末」,\npmids:「始」[\"37900001\", \"37900002\"]「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_cited_by",
        "description": "查询某篇文章（PMID）被哪些 PubMed 文献引用（cited-in 列表）。\n\n参数：\n- command (字符串, 必需): 固定为 \"get_cited_by\"。\n- pmid (字符串, 必需): PubMed ID。\n- max_results (数字, 可选): 最大返回的被引文数量，默认 100，上限 1000。\n\n返回：\n- JSON 字段：\n  {\n    \"pmid\": string,\n    \"citationCount\": number,\n    \"citedBy\": string[]\n  }\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」get_cited_by「末」,\npmid:「始」12345678「末」,\nmax_results:「始」200「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」get_cited_by「末」,\npmid:「始」37912345「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_references",
        "description": "获取指定 PMID 对应文章的参考文献列表（其引用了哪些文献）。\n\n参数：\n- command (字符串, 必需): 固定为 \"get_references\"。\n- pmid (字符串, 必需): PubMed ID。\n- max_results (数字, 可选): 最大返回的参考文献数，默认 100，上限 1000。\n\n返回：\n- JSON 字段：\n  {\n    \"pmid\": string,\n    \"referenceCount\": number,\n    \"references\": string[]\n  }\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」get_references「末」,\npmid:「始」12345678「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」get_references「末」,\npmid:「始」37912345「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "get_similar_articles",
        "description": "基于 PubMed 提供的 neighbor_score，相似性推荐相关文献列表。\n\n参数：\n- command (字符串, 必需): 固定为 \"get_similar_articles\"。\n- pmid (字符串, 必需): PubMed ID。\n- max_results (数字, 可选): 最大相似文献数，默认 20，上限 100。\n\n返回：\n- JSON 字段：\n  {\n    \"pmid\": string,\n    \"similarArticles\": string[]\n  }\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」get_similar_articles「末」,\npmid:「始」12345678「末」,\nmax_results:「始」30「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」get_similar_articles「末」,\npmid:「始」37912345「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "export_citation",
        "description": "将指定 PMID 的文献信息导出为常见引用格式（APA / MLA / Chicago / BibTeX / RIS）。\n\n参数：\n- command (字符串, 必需): 固定为 \"export_citation\"。\n- pmid (字符串, 必需): PubMed ID。\n- format (字符串, 可选): 引用格式，枚举值：\n  - \"apa\"\n  - \"mla\"\n  - \"chicago\"\n  - \"bibtex\"\n  - \"ris\"\n  默认 \"apa\"。\n\n返回：\n- JSON 字段：\n  {\n    \"pmid\": string,\n    \"format\": string,\n    \"citation\": string\n  }\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」export_citation「末」,\npmid:「始」12345678「末」,\nformat:「始」bibtex「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」export_citation「末」,\npmid:「始」37912345「末」,\nformat:「始」ris「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "validate_pmid",
        "description": "校验给定 PMID 的格式是否正确，并检查该 ID 对应文章是否真实存在。\n\n参数：\n- command (字符串, 必需): 固定为 \"validate_pmid\"。\n- pmid (字符串, 必需): 待校验的 PubMed ID。\n\n返回：\n- JSON 字段：\n  - 如果格式错误：\n    {\n      \"valid\": false,\n      \"pmid\": string,\n      \"message\": \"Invalid PMID format. PMID must contain only digits.\"\n    }\n  - 如果格式正确：\n    {\n      \"valid\": true,\n      \"pmid\": string,\n      \"exists\": boolean,\n      \"message\": string\n    }\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」validate_pmid「末」,\npmid:「始」12345678「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」validate_pmid「末」,\npmid:「始」\"abc123\"「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "commandIdentifier": "convert_identifiers",
        "description": "在 PMID、DOI、PMCID 之间进行互相转换。支持自动识别输入类型（auto）。\n\n参数：\n- command (字符串, 必需): 固定为 \"convert_identifiers\"。\n- identifier (字符串, 必需): 任意一种标识符（PMID、DOI 或 PMC ID）。\n- identifier_type (字符串, 可选): 标识符类型，可选：\"pmid\" | \"doi\" | \"pmcid\" | \"auto\"，默认 \"auto\"。\n\n行为：\n- 当 identifier_type = \"auto\" 时，将依次尝试：\n  - isValidPMID(identifier) → \"pmid\"\n  - isValidDOI(identifier) → \"doi\"\n  - isValidPMCID(identifier) → \"pmcid\"\n  若均失败，返回错误。\n\n返回：\n- JSON 字段：\n  {\n    \"inputId\": string,\n    \"inputType\": string,\n    \"conversions\": {\n      \"pmid\"?: string,\n      \"doi\"?: string,\n      \"pmcid\"?: string\n    },\n    \"error\"?: string\n  }\n\n调用示例：\n<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」convert_identifiers「末」,\nidentifier:「始」10.1038/s41586-023-XXXX-X「末」,\nidentifier_type:「始」doi「末」\n<<<[END_TOOL_REQUEST]>>>",
        "example": "<<<[TOOL_REQUEST]>>>\nmaid:「始」你的名字「末」,\ntool_name:「始」PubMedSearch「末」,\ncommand:「始」convert_identifiers「末」,\nidentifier:「始」PMC1234567「末」,\nidentifier_type:「始」auto「末」\n<<<[END_TOOL_REQUEST]>>>"
      }
    ]
  }
}