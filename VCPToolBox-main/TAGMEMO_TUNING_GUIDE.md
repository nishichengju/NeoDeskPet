# TagMemo V3.7 算法参数调优指南 (工程化参考)

本指南详细说明了 TagMemo 算法中可动态调控的参数。所有参数均可通过 `rag_params.json` 实时调整，无需重启服务器。

---

## 1. RAGDiaryPlugin (前端意图感知层)

### 1.1 `noise_penalty` (语义宽度惩罚)
*   **默认值**: `0.05`
*   **建议区间**: `0.01` ~ `0.20`
*   **物理意义**: 抵消“语义宽度 (S)”带来的噪音。当用户说话非常发散时，该值决定了我们要多大程度上抑制标签增强。
*   **调优逻辑**:
    *   **调高**: 算法会变得非常“挑剔”。只有当语义非常聚焦时才会触发强增强。适合防止在闲聊中误触发无关记忆。
    *   **调低**: 算法更宽容。即使对话比较发散，也会尝试通过标签寻找关联。

### 1.2 `tagWeightRange` (标签权重映射区间)
*   **默认值**: `[0.05, 0.45]`
*   **建议区间**: 下限 `0.01`~`0.10`；上限 `0.30`~`0.60`
*   **物理意义**: 映射 $\beta$ 值的物理范围。决定了“标签语义”在最终检索向量中占据的最大能量比例。
*   **调优逻辑**:
    *   **上限调高 (如 0.60)**: 检索结果会极度向标签靠拢。如果标签感应准确，结果会非常惊艳；如果感应偏差，结果会完全跑题。
    *   **上限调低 (如 0.30)**: 检索更稳健，更依赖原始文本向量，标签仅作为微调。

### 1.3 `tagTruncationBase` (标签截断基准)
*   **默认值**: `0.6`
*   **建议区间**: `0.4` ~ `0.8`
*   **物理意义**: 在感应阶段，保留前百分之多少的标签。
*   **调优逻辑**:
    *   **调高 (如 0.8)**: 保留更多长尾标签。增加召回的多样性，但可能引入弱相关的噪音。
    *   **调低 (如 0.4)**: 极度精简。只保留最核心的几个标签，检索精度最高，但可能丢失一些侧面信息。

---

## 2. KnowledgeBaseManager (后端语义引擎层)

### 2.1 `activationMultiplier` (金字塔激活增益)
*   **默认值**: `[0.5, 1.5]` (对应公式 `0.5 + activation * 1.5`)
*   **建议区间**: 基础值 `0.2`~`0.8`；缩放值 `1.0`~`2.5`
*   **物理意义**: 决定了残差金字塔发现的“新颖特征”对最终权重的贡献度。
*   **调优逻辑**:
    *   **缩放值调高**: 算法对对话中的“新信息”反应更剧烈，检索结果会迅速转向新出现的关键词。
    *   **缩放值调低**: 算法更迟钝，倾向于维持长期的语义重心。

### 2.2 `dynamicBoostRange` (动态增强修正)
*   **默认值**: `[0.3, 2.0]`
*   **建议区间**: 下限 `0.1`~`0.5`；上限 `1.5`~`3.0`
*   **物理意义**: 后端根据 EPA（逻辑深度/共振）分析结果，对前端传入权重的二次修正。
*   **调优逻辑**:
    *   **上限调高 (如 3.0)**: 在逻辑极度严密或产生强烈共振时，允许标签权重突破天际。
    *   **下限调低 (如 0.1)**: 在对话逻辑混乱时，几乎完全关闭标签增强，退化为普通向量检索。

### 2.3 `coreBoostRange` (核心标签聚光灯)
*   **默认值**: `[1.20, 1.40]`
*   **建议区间**: `1.10` ~ `2.00`
*   **物理意义**: 对用户手动指定的 `coreTags` 的额外能量加权。
*   **调优逻辑**:
    *   **调高 (如 1.80)**: 给予手动标签“特权”。只要用户指定了某个标签，检索结果会强行向该标签对齐。
    *   **调低 (如 1.10)**: 手动标签仅作为参考，不破坏整体语义平衡。

### 2.4 `deduplicationThreshold` (语义去重阈值)
*   **默认值**: `0.88`
*   **建议区间**: `0.80` ~ `0.95`
*   **物理意义**: 两个标签之间余弦相似度超过多少时合并。
*   **调优逻辑**:
    *   **调高 (如 0.95)**: 几乎不去重。保留所有细微差别的词，标签云会很拥挤。
    *   **调低 (如 0.80)**: 强力去重。语义接近的词会被大量合并，标签云更清爽，但可能丢失细节。

### 2.5 `techTagThreshold` (技术噪音门槛)
*   **默认值**: `0.08`
*   **建议区间**: `0.02` ~ `0.20`
*   **物理意义**: 英文/技术词汇在非技术语境下的生存门槛。
*   **调优逻辑**:
    *   **调高 (如 0.15)**: 强力过滤。对话中偶尔出现的代码片段、文件名等不会干扰 RAG。
    *   **调低 (如 0.03)**: 允许更多技术词汇参与检索。适合本身就是技术讨论的语境。

